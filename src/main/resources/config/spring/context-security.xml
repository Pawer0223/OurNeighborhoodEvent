<?xml version="1.0" encoding="UTF-8"?>
<beans:beans
	xmlns="http://www.springframework.org/schema/security"
	xmlns:beans="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans
                                 http://www.springframework.org/schema/beans/spring-beans.xsd
                                 http://www.springframework.org/schema/security
                                 http://www.springframework.org/schema/security/spring-security-4.1.xsd">

	<http auto-config="true" use-expressions="true">
		<intercept-url pattern="/nor/**" access="hasAnyRole('ROLE_NORMAL' , 'ROLE_PARTNER' , 'ROLE_ADMIN')" />
		<intercept-url pattern="/ptn/**" access="hasRole('ROLE_PARTNER')" />
		<intercept-url pattern="/adm/**" access="hasRole('ROLE_ADMIN')" />
		<intercept-url pattern="/**" access="permitAll" />
			
	  	 <!-- 권한 설정 -->    
	    <form-login
	        username-parameter="username"
	        password-parameter="password"
	        login-processing-url="/loginProcess.do"
	        login-page="/com/loginPage.do"
	        default-target-url="/"
	    />

		<access-denied-handler
		    error-page="/access_denied_page.do"
		/>

	   <logout
	        logout-url="/logout.do"
	        logout-success-url="/"
	    />
	</http>

		
	<jdbc-user-service data-source-ref="dataSource" id="userService"
		users-by-username-query="SELECT USER_ID as username, USER_PW as password, ENABLED FROM USER_INFOS WHERE USER_ID=?"
		authorities-by-username-query="SELECT USER_ID as loginID, AUTHORITY_NAME as AUTHORITY FROM AUTHORITY WHERE USER_ID=?"
	/>

	<authentication-manager>
          <authentication-provider user-service-ref="userService">
            </authentication-provider>
	</authentication-manager>
	
	

</beans:beans>